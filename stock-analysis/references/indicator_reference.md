# 技术指标参考指南

本文档详细说明 stock-analysis 中的 40+ 技术指标，包括计算原理、应用场景、参数解释。

## 指标速查表

| 大类 | 指标 | 缩写 | 周期 | 应用场景 | 信号范围 |
|------|------|------|------|--------|---------|
| **趋势** | 指数移动平均 | EMA | 5,10,20,60 | 趋势确认 | 连续值 |
| | MACD 趋势转换 | MACD | (12,26,9) | 趋势反转 | -1到1 |
| | ADX 趋势力度 | ADX | 14,7 | 趋势强度评估 | 0-100 |
| **动量** | RSI 相对强度 | RSI | 7,14 | 超买超卖 | 0-100 |
| | CCI 商品通道 | CCI | 14,7 | 极端偏离 | -200到200 |
| | KDJ 随机指标 | STOCH | 9,3,3 | 周期顶底 | 0-100 |
| **波动** | ATR 真实波幅 | ATR | 3,14 | 止损设置 | 连续值 |
| | 布林带 | BBANDS | (5,2,2) | 震荡区间 | 0-1 |
| **成交量** | OBV 能量潮 | OBV | N/A | 资金流向 | 连续值 |
| | A/D 积累分布 | AD | N/A | 吸筹派发 | 连续值 |
| | 成交量 SMA | VSMA | 5,10,20 | 成交活跃度 | 连续值 |
| **基础** | 涨幅 | CHANGE | 1,5,10,20 | 多周期收益率 | -100到100 |
| | 中间价 | MIDPRICE | N/A | 开盘参考 | 连续值 |

---

## 分类详解

### I. 趋势方向指标

#### 1. EMA (指数移动平均)

**计算原理**: 对近期数据赋予更高权重的移动平均线。

$$
EMA_t = \frac{2}{N+1} \cdot Close_t + \left(1 - \frac{2}{N+1}\right) \cdot EMA_{t-1}
$$

**默认周期**: 5, 10, 20, 60 日

**使用场景**:
- **均线分析**: EMA_5 > EMA_10 > EMA_20 表示强势上升
- **支撑阻力**: 价格在 EMA_20 上方为多头市场
- **趋势确认**: EMA 方向改变前，通常早于价格

**信号示例**:
```
看涨信号:
  - 短期 EMA(5) 上穿中期 EMA(20)
  - 价格运行在所有 EMA 上方

看跌信号:
  - 短期 EMA(5) 下穿长期 EMA(60)
  - 价格运行在所有 EMA 下方
```

---

#### 2. MACD (Moving Average Convergence Divergence)

**计算原理**: 两条 EMA 的差离及其信号线。

$$
MACD = EMA_{12} - EMA_{26}
$$
$$
Signal = EMA_9(MACD)
$$
$$
Histogram = MACD - Signal
$$

**默认参数**: (12, 26, 9)

**输出列**: `macd`, `macd_signal`, `macd_hist`

**使用场景**:
- **趋势确认**: MACD > 0 表示上升趋势，< 0 表示下降趋势
- **动能研判**: Histogram 大小反映趋势强度
- **买卖信号**: MACD 上穿 Signal 为买入，下穿为卖出

**信号示例**:
```
看涨信号:
  - MACD 从负值上穿到正值
  - MACD 线上穿信号线（Signal），且 Histogram 扩大
  - MACD 为正值，且远离零轴

看跌信号:
  - MACD 从正值下穿到负值
  - MACD 线下穿信号线，且 Histogram 扩大
  - MACD 为负值，底部距离越远越强
```

---

#### 3. ADX (Average Directional Index)

**计算原理**: 评估趋势强度的指标，结合 +DI 和 -DI 方向。

**默认周期**: 14, 7

**输出列**: `adx_14`, `adx_7`, `+di_14`, `-di_14`, `+di_7`, `-di_7`

**ADX 区间解释**:
| ADX 值 | 趋势强度 | 建议操作 |
|-------|--------|--------|
| 0-20 | 极弱/无趋势 | 观望或日内 |
| 20-40 | 较强 | 顺势操作 |
| 40+ | 非常强 | 强势跟风 |

**方向判断**:
- **+DI > -DI**: 上升趋势占优
- **-DI > +DI**: 下降趋势占优
- **两者接近**: 趋势不明确，谨慎操作

**信号示例**:
```
看涨信号:
  - ADX > 20 且 +DI > -DI（趋势向上且强度足够）
  - +DI 上穿 -DI，同时 ADX > 20

看跌信号:
  - ADX > 20 且 -DI > +DI（趋势向下且强度足够）
  - -DI 上穿 +DI，同时 ADX > 20
```

---

### II. 动量指标

#### 4. RSI (Relative Strength Index)

**计算原理**: 衡量涨幅与跌幅的相对强度。

$$
RSI = 100 - \frac{100}{1 + RS}，其中 RS = \frac{平均上升幅度}{平均下跌幅度}
$$

**默认周期**: 7, 14

**信号区间**:
| RSI 值 | 含义 | 操作建议 |
|-------|------|---------|
| 70+ | 超买 | 考虑减持或卖出 |
| 50-70 | 强势 | 看涨 |
| 30-50 | 弱势 | 看跌 |
| 30- | 超卖 | 考虑建仓或买入 |

**应用**:
- 短周期 RSI(7) 用于日内交易，敏感度高
- 长周期 RSI(14) 用于中线分析，信号稳定

**信号示例**:
```
看涨信号:
  - RSI 从超卖区(30以下)反弹到 50 以上
  - RSI 虽未超买，但保持在 50-70 区间
  - RSI 底背离（价格新低，RSI 未创新低）

看跌信号:
  - RSI 从超买区(70以上)回落到 50 以下
  - RSI 虽未超卖，但保持在 30-50 区间
  - RSI 顶背离（价格新高，RSI 未创新高）
```

---

#### 5. CCI (Commodity Channel Index)

**计算原理**: 衡量价格偏离平均值的程度。

$$
CCI = \frac{典型价格 - SMA(典型价格)}{0.015 \times 平均绝对偏差}
$$

其中：$典型价格 = \frac{High + Low + Close}{3}$

**默认周期**: 14, 7

**信号区间**:
| CCI 值 | 含义 |
|-------|------|
| 100+ | 极端高位（超买） |
| -100- | 极端低位（超卖） |
| -100 ~ 100 | 正常区间 |

**应用**:
- CCI 突破 ±100 表示价格极端偏离，可能反转
- 用于发现市场异常和极端情况
- 配合其他指标判断反转概率

**信号示例**:
```
看涨信号:
  - CCI 从 -100 以下快速回升到 0 以上
  - CCI 上穿 100 线，表示向上突破极端

看跌信号:
  - CCI 从 100 以上快速回落到 0 以下
  - CCI 下穿 -100 线，表示向下突破极端
```

---

#### 6. STOCH (KDJ 随机指标)

**计算原理**: 衡量收盘价在一定周期内的相对位置。

$$
RSV = \frac{Close - Low_{N}}{High_{N} - Low_{N}} \times 100
$$
$$
K = \frac{2}{3} \cdot K_{prev} + \frac{1}{3} \cdot RSV
$$
$$
D = \frac{2}{3} \cdot D_{prev} + \frac{1}{3} \cdot K
$$

**默认参数**: (9, 3, 3)

**输出列**: `stoch_k`, `stoch_d`

**信号区间**:
| K/D 值 | 含义 |
|-------|------|
| 80+ | 超买 |
| 50 | 中位 |
| 20- | 超卖 |

**应用**:
- K 线突破 D 线：K > D 为上升信号，K < D 为下降信号
- 顶底判断：K 和 D 同时高于 80 或低于 20 时反转概率大

**信号示例**:
```
看涨信号:
  - K 线从超卖区(20以下)上穿 D 线
  - K、D 都在 20-50 之间，K > D

看跌信号:
  - K 线从超买区(80以上)下穿 D 线
  - K、D 都在 50-80 之间，K < D
```

---

### III. 波动指标

#### 7. ATR (Average True Range)

**计算原理**: 真实波幅的平均值，反映市场波动程度。

$$
TR = \max(High - Low, |High - Close_{prev}|, |Low - Close_{prev}|)
$$
$$
ATR_N = SMA(TR, N)
$$

**默认周期**: 3, 14

**应用**:
- **波动评估**: ATR 高表示波动大，适合短线；ATR 低表示波动小，需耐心
- **止损设置**: ATR × 倍数作为止损距离（如 ATR × 2）
- **仓位管理**: ATR 越高，单位仓位应越小

**典型用法**:
```
止损点 = 入场价 - ATR(14) × 1.5 (做多)
止损点 = 入场价 + ATR(14) × 1.5 (做空)
```

**信号示例**:
```
看涨信号:
  - ATR 维持在相对高位，表示上升趋势活跃
  - ATR 短期下降后重新上升，表示趋势加速

看跌信号:
  - ATR 极度萎缩，价格即将大幅波动
  - ATR 快速扩大且向下，表示下跌加速
```

---

#### 8. Bollinger Bands (布林带)

**计算原理**: 基于 SMA 和标准差的动态支撑阻力。

$$
中线 = SMA(Close, N)
$$
$$
上线 = 中线 + K \times \sigma
$$
$$
下线 = 中线 - K \times \sigma
$$

其中 σ 为标准差，K 通常为 2。

**默认参数**: (5, 2.0, 2.0, SMA)

**输出列**: `bb_upper`, `bb_middle`, `bb_lower`, `bb_bandwidth`, `bb_pct`

**参数说明**:
- `bb_pct`: 价格在上下轨间的相对位置 (0-1)
  - 0.5 表示在中线
  - 接近 1 表示接近上轨（过热）
  - 接近 0 表示接近下轨（过冷）
- `bb_bandwidth`: 布林带宽度，反映波动率

**应用**:
- **支撑阻力**: 价格触及上/下轨可作为交易信号
- **波动率**: 带宽扩张表示波动增加，收缩表示波动减少
- **突破确认**: 价格突破上轨表示看涨突破

**信号示例**:
```
看涨信号:
  - 价格从下轨反弹，回到中线并上穿
  - 布林带向上扩张，表示上升动能强
  - 价格运行在中线上方，接近上轨

看跌信号:
  - 价格从上轨回落，跌破中线
  - 布林带向下收缩后突然扩张，向下突破
  - 价格运行在中线下方，接近下轨
```

---

### IV. 成交量指标

#### 9. OBV (On-Balance Volume)

**计算原理**: 将成交量按价格方向进行累加，反映资金流向。

$$
OBV_t = \begin{cases}
OBV_{t-1} + Volume_t & \text{if } Close_t > Close_{t-1} \\
OBV_{t-1} - Volume_t & \text{if } Close_t < Close_{t-1} \\
OBV_{t-1} & \text{if } Close_t = Close_{t-1}
\end{cases}
$$

**应用**:
- **趋势确认**: OBV 上升趋势确认价格上升真实性
- **底背离**: 价格新低但 OBV 未创新低，可能反转
- **顶背离**: 价格新高但 OBV 未创新高，可能反转

**信号示例**:
```
看涨信号:
  - OBV 处于上升趋势，与价格配合
  - OBV 创新高的同时价格也创新高

看跌信号:
  - OBV 处于下降趋势，与价格配合
  - OBV 创新低的同时价格也创新低

反转信号:
  - 价格新高但 OBV 未创新高（顶背离）
  - 价格新低但 OBV 未创新低（底背离）
```

---

#### 10. A/D (Accumulation/Distribution)

**计算原理**: 将成交量按价格位置进行加权，反映吸筹与派发。

$$
CLV = \frac{Close - Low - (High - Close)}{High - Low}
$$
$$
AD_t = AD_{t-1} + CLV_t \times Volume_t
$$

其中 CLV 为收盘位置线（0-1）。

**应用**:
- **吸筹派发**: A/D 上升表示吸筹（看涨预期），下降表示派发（看跌预期）
- **量价配合**: A/D 与价格同向确认趋势真实性
- **背离判断**: A/D 与价格背离表示即将反转

**与 OBV 的区别**:
- OBV: 只关心涨跌，不关心涨跌幅度
- A/D: 关心价格在日内的位置，收盘位置越高权重越大

---

#### 11. 成交量 SMA 和 VWMA

**成交量 SMA**: 成交量的简单移动平均

$$
VSMA_N = \frac{1}{N} \sum_{i=0}^{N-1} Volume_{t-i}
$$

**默认周期**: 5, 10, 20

**应用**:
- 判断成交活跃度相对高低
- 成交量突破 SMA 表示成交放量

**成交量加权均线 VWMA**: 用成交量加权的价格均线

$$
VWMA_N = \frac{\sum_{i=0}^{N-1} Close_{t-i} \times Volume_{t-i}}{\sum_{i=0}^{N-1} Volume_{t-i}}
$$

**默认周期**: 5, 10

**应用**:
- 比 EMA 更加权衡大单子的影响
- 用于判断市场的真实平均成本

---

### V. 基础指标

#### 12. CHANGE (多周期涨幅)

**计算原理**: 价格相对于 N 周期前的百分比变化。

$$
CHANGE_N = \frac{Close_t - Close_{t-N}}{Close_{t-N}} \times 100\%
$$

**默认周期**: 1, 5, 10, 20 日

**输出列**: `change_1`, `change_5`, `change_10`, `change_20`

**应用**:
- **收益率**: 直观查看不同周期的收益率
- **动能**: Change 值大的正数表示强势，负数表示弱势
- **信号**: 配合其他指标作为过滤条件

---

#### 13. MIDPRICE (中间价)

**计算原理**: 简单计算日内最高价和最低价的中点。

$$
MIDPRICE = \frac{High + Low}{2}
$$

**应用**:
- **开盘参考**: 作为当日开盘的可能目标
- **支撑阻力**: 使用中间价的集合作为关键价位
- **简化分析**: 比 SMA 计算更快

---

## 综合应用策略

### 1. 趋势跟踪策略

```
指标组合: EMA, MACD, ADX
入场: EMA_5 > EMA_20，MACD > 0，ADX > 20
出场: EMA_5 下穿 EMA_20 或 ADX < 20
```

### 2. 超买超卖策略

```
指标组合: RSI, STOCH, BBANDS
入场: RSI < 30 且 K < 20 且价格接近下轨
出场: RSI > 70 或价格反弹至中线以上
```

### 3. 趋势 + 背离策略

```
指标组合: MACD, OBV, CCI
入场: 价格创新高但 MACD/OBV 未创新高（顶背离，做空）
      价格创新低但 MACD/OBV 未创新低（底背离，做多）
出场: 新的背离出现或收盘突破
```

### 4. 波动突破策略

```
指标组合: ATR, BBANDS, 成交量
入场: 价格突破布林带上/下轨且 ATR 扩张且成交量放大
出场: ATR 突然收缩或价格重新进入布林带
```

---

## 参数优化建议

| 市场阶段 | 推荐参数调整 |
|--------|------------|
| **强势上升** | 缩短 EMA 周期(3,5,10)，MACD(6,13,5)，提高 RSI 阈值(40,80) |
| **震荡整理** | 延长周期，使用 BBANDS 和 KDJ，降低 RSI 阈值(30,70) |
| **弱势下降** | 使用 MACD 和 ADX 确认，不依赖 RSI 的超卖信号 |
| **高波动** | 增加 ATR 权重，使用较长周期平滑，宽松的 BBANDS |

